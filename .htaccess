# ============================================
# SEO 2.0 - DYNAMIC RENDERING FOR BOTS CAUSE SPA CONTENT 
# ============================================
RewriteEngine On

# 1. BLOQUE l'accès direct au fichier PHP
RewriteRule ^render-for-bots\.php$ - [R=404,L]

# 2. REDIRECTION BOTS vers HTML statique
RewriteCond %{HTTP_USER_AGENT} (googlebot|bingbot|yandex|baiduspider|twitterbot|facebookexternalhit|linkedinbot|whatsapp|pinterest|slackbot|telegrambot|discordbot|applebot|duckduckbot|facebot|ia_archiver|Mediapartners\-Google) [NC]
RewriteRule ^projet/([a-zA-Z0-9_-]+)/?$ /render-for-bots.php?slug=$1 [L]

# 3. REDIRECTION HUMAINS vers SPA (#anchor)
RewriteCond %{HTTP_USER_AGENT} !(googlebot|bingbot|yandex|baiduspider|twitterbot|facebookexternalhit|linkedinbot|whatsapp|pinterest|slackbot|telegrambot|discordbot|applebot|duckduckbot|facebot|ia_archiver|Mediapartners\-Google) [NC]
RewriteRule ^projet/([a-zA-Z0-9_-]+)/?$ /#project-$1 [R=302,L]

# ============================================
# CONFIGURATION EXISTANTE (conserve)
# ============================================
# Empêcher l'accès direct à config.php
<Files "config.php">
    Order allow,deny
    Deny from all
</Files>
<Files "auth.php">
    Order allow,deny
    Deny from all
</Files>

# Forcer POST pour submit.php
<Files "submit.php">
    <IfModule mod_rewrite.c>
        RewriteEngine On
        RewriteCond %{REQUEST_METHOD} !POST
        RewriteRule ^ - [F,L]
    </IfModule>
</Files>

# Désactiver l'affichage des erreurs PHP en prod
php_flag display_errors off